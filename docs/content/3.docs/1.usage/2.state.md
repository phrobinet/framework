# Ã‰tat

Nuxt fournit `useState` composable pour crÃ©er un Ã©tat partagÃ© rÃ©actif et SSR-friendly Ã  travers les composants.

`useState` est un remplacement [`ref`](https://v3.vuejs.org/api/refs-api.html#ref) compatible avec SSR. Sa valeur sera prÃ©servÃ©e aprÃ¨s le rendu cÃ´tÃ© serveur (pendant l'hydratation cÃ´tÃ© client) et partagÃ©e entre tous les composants en utilisant une clÃ© unique.

## Signature

```ts
useState<T>(key: string, init?: () => T): Ref<T>
```

* **key** : Une clÃ© unique assurant que la rÃ©cupÃ©ration des donnÃ©es peut Ãªtre correctement dÃ©-dupliquÃ©e Ã  travers les requÃªtes.
**init** : Une fonction qui fournit une valeur initiale pour l'Ã©tat lorsqu'il n'est pas initiÃ©.
* **T** : (typescript uniquement) SpÃ©cifier le type d'Ã©tat.

::alert{icon=ğŸ‘‰}
`useState` only works during `setup` or [`Lifecycle Hooks`](https://v3.vuejs.org/guide/composition-api-lifecycle-hooks.html#lifecycle-hooks).
::

## Meilleures pratiques

::alert{type=danger icon=ğŸš¨}
Ne dÃ©finissez jamais `const state = ref()` en dehors de la fonction `<script setup>` ou `setup()`.<br>.
Un tel Ã©tat sera partagÃ© entre tous les utilisateurs qui visitent votre site Web et peut entraÃ®ner des fuites de mÃ©moire !
::
::alert{type=success icon=âœ…}
Utilisez plutÃ´t `const useX = () => useState('x')`.
::

## Exemples

### Utilisation de base

Dans cet exemple, nous utilisons un Ã©tat de compteur local au composant. Tout autre composant qui utilise `useState('counter')` partage le mÃªme Ã©tat rÃ©actif.

```vue [app.vue]
<script setup>
const counter = useState('counter', () => Math.round(Math.random() * 1000))
</script>

<template>
  <div>
    Counter: {{ counter }}
    <button @click="counter++">
      +
    </button>
    <button @click="counter--">
      -
    </button>
  </div>
</template>
```

:button-link[Open on StackBlitz]{href="https://stackblitz.com/github/nuxt/framework/tree/main/examples/use-state?terminal=dev" blank}

### AvancÃ©

Dans cet exemple, nous utilisons un composable qui dÃ©tecte la locale par dÃ©faut de l'utilisateur Ã  partir des en-tÃªtes de requÃªte HTTP et la conserve dans un Ã©tat `locale`.

:button-link [Ouvrir sur StackBlitz]{href="https://stackblitz.com/github/nuxt/framework/tree/main/examples/locale?terminal=dev" blank}

## Ã‰tat partagÃ©

En utilisant [auto-imported composables](/docs/directory-structure/composables), nous pouvons dÃ©finir des Ã©tats globaux sÃ»rs et les importer dans toute l'application.

```ts [composables/states.ts]
export const useCounter = () => useState<number>('counter', () => 0)
export const useColor = () => useState<string>('color', () => 'pink')
```

```vue [app.vue]
<script setup>
const color = useColor() // Same as useState('color')
</script>

<template>
  <p>Current color: {{ color }}</p>
</template>
```
