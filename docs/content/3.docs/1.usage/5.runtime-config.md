# Configuration d'ex√©cution

Nuxt fournit une API pour d√©finir la configuration d'ex√©cution dans votre application et les routes API.

## Exposer la configuration d'ex√©cution

Pour exposer la configuration et les variables d'environnement au reste de votre application, vous devrez d√©finir la configuration d'ex√©cution dans votre fichier `nuxt.config`, en utilisant soit les options [`privateRuntimeConfig` ou `publicRuntimeConfig`](/docs/directory-structure/nuxt.config#privateruntimeconfig) (selon que vous voulez qu'elle soit accessible ou non sur la partie client de votre application).

**Exemple:**

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  publicRuntimeConfig: {
    API_BASE: '/api'
  },
  privateRuntimeConfig: {
    API_SECRET: '123'
  }
})
```

En ajoutant `API_BASE` au `publicRuntimeConfig`, Nuxt l'ajoute √† la charge utile des pages. De cette fa√ßon, nous pouvons acc√©der universellement √† `API_BASE` √† la fois sur le serveur et dans le navigateur.

### Variables d'environnement

La fa√ßon la plus commune de fournir une configuration est d'utiliser des [Variables d'environnement] (https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa).
Nuxt CLI a un support int√©gr√© de [dotenv](https://github.com/motdotla/dotenv).

En plus de toutes les variables d'environnement du processus, si vous avez un fichier `.env` dans le r√©pertoire racine de votre projet, il sera automatiquement charg√© dans `process.env` et accessible dans votre fichier `nuxt.config` et vos modules.

**Exemple:**

```sh [.env]
BASE_URL=https://nuxtjs.org
API_SECRET=api_secret_token
```

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  publicRuntimeConfig: {
    BASE_URL: process.env.BASE_URL
  },
  privateRuntimeConfig: {
    API_SECRET: process.env.API_SECRET
  }
})
```

**üí° Astuce:** Bien que cela ne soit pas n√©cessaire, en utilisant des noms de configuration d'ex√©cution identiques en tant que variables env, vous pouvez facilement les remplacer en production en utilisant des variables d'environnement de plate-forme.

## Acc√®s √† la configuration d'ex√©cution

### Application Vue

Dans la partie Vue de votre application Nuxt, vous devrez appeler `useRuntimeConfig()` pour acc√©der √† la configuration d'ex√©cution.

**Note:** Le comportement est diff√©rent entre le c√¥t√© client et le c√¥t√© serveur :

- C√¥t√© client, seul `publicRuntimeConfig` est disponible et l'objet est √† la fois accessible en √©criture et r√©actif.
- C√¥t√© serveur, `publicRuntimeConfig` et `privateRuntimeConfig` sont fusionn√©s et l'objet est en lecture seule pour √©viter le partage de contexte.

```vue
<template>
  <div>
    <div>Token: {{ config.API_AUTH_TOKEN }}</div>
  </div>
</template>

<script setup>
const config = useRuntimeConfig()
</script>
```

**üõë Note de s√©curit√©:** Ne jamais utiliser l'exemple ci-dessus si `API_AUTH_TOKEN` est une configuration priv√©e. M√™me si vous utilisez `privateRuntimeConfig`, vous devez toujours faire attention √† ne pas exposer cette configuration √† la charge utile ou au html !

::alert{icon=üëâ}
**`useRuntimeConfig` ne fonctionne que pendant `setup` ou `Lifecycle Hooks`**.
::

### Routes API

Dans les routes API, vous pouvez acc√©der √† la configuration du runtime en important directement depuis le virtuel `#config`.

```ts
import config from '#config'

export default async () => {
  const result = await $fetch('https://my.api.com/test', {
    headers: {
      Authorization: `Bearer ${config.API_AUTH_TOKEN}`
    }
  })
  return result
}
```

### Saisir la configuration d'ex√©cution

Actuellement, il est possible de saisir manuellement votre configuration d'ex√©cution.

```ts [index.d.ts]
declare module '@nuxt/schema' {
  interface PublicRuntimeConfig {
    testConfig: string
  }
  interface PrivateRuntimeConfig {
    token: string
  }
}
// Il est toujours important de s'assurer que vous importez/exportez quelque chose lorsque vous augmentez un type.
export {}
```
